sort and remove duplicate elements from an iterator based on a key and returns an array
