This function runs all coroutines until they are finished.
