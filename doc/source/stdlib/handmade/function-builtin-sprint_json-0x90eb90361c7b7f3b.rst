similar to 'write_json' but skips intermediate representation. this is faster but less flexible
